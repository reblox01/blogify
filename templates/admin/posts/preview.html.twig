{% extends 'admin/layout.html.twig' %}

{% block title %}Preview: {{ post.title }}{% endblock %}

{% block admin_content %}
    <div class="mb-6 flex items-center justify-between">
        <a href="{{ path('admin_posts') }}" class="flex items-center text-gray-500 hover:text-gray-700 transition-colors">
            <i data-lucide="arrow-left" class="w-4 h-4 mr-2"></i> Back to Posts
        </a>
        <div class="flex gap-2">
            <span class="px-3 py-1 text-sm rounded-full 
                {% if post.status == 'published' %}bg-green-100 text-green-800
                {% elseif post.status == 'rejected' %}bg-red-100 text-red-800
                {% else %}bg-yellow-100 text-yellow-800{% endif %}">
                Status: {{ post.status|capitalize }}
            </span>
        </div>
    </div>

    {# Preview Container - Simulates the real blog view #}
    <div class="bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden max-w-4xl mx-auto">
        {% if post.imagePath %}
            <div class="h-64/ w-full overflow-hidden bg-gray-100">
                <img src="{{ asset('images/' ~ post.imagePath) }}" alt="{{ post.title }}" class="w-full h-full object-cover">
            </div>
        {% endif %}

        <div class="p-8 lg:p-12">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">{{ post.title }}</h1>
            
            <div class="flex items-center gap-4 text-sm text-gray-500 mb-8 pb-8 border-b border-gray-100">
                <div class="flex items-center gap-2">
                    <div class="avatar placeholder">
                         <div class="bg-teal-100 text-teal-700 rounded-full w-8 h-8 flex items-center justify-center">
                            <span class="font-bold">{{ post.user.email|first|upper }}</span>
                        </div>
                    </div>
                    <span>{{ post.user.email }}</span>
                </div>
                <span>â€¢</span>
                <span>{{ post.createdAt|date('F j, Y') }}</span>
            </div>

            <div class="prose prose-lg prose-teal max-w-none text-gray-700">
                {# Render raw html for WYSIWYG content, but ensure we sanitize on input in real app #}
                {{ post.description|raw }} 
            </div>
        </div>

        {# Sticky Moderation Footer #}
        <div class="bg-gray-50 p-4 border-t border-gray-200 flex items-center justify-between sticky bottom-0">
            <div class="text-sm text-gray-500">
                Admin Action Required
            </div>
            <div class="flex gap-3">
                 <form action="{{ path('admin_post_status', {id: post.id}) }}" method="POST">
                    <input type="hidden" name="status" value="rejected">
                    <button type="submit" class="btn btn-sm btn-error btn-outline gap-2">
                        <i data-lucide="x" class="w-4 h-4"></i> Reject
                    </button>
                </form>
                <form action="{{ path('admin_post_status', {id: post.id}) }}" method="POST">
                    <input type="hidden" name="status" value="published">
                    <button type="submit" class="btn btn-sm btn-success text-white gap-2">
                        <i data-lucide="check" class="w-4 h-4"></i> Approve & Publish
                    </button>
                </form>
            </div>
        </div>
    </div>
{% endblock %}
